{"version":3,"sources":["../../node_modules/tslib/tslib.es6.js","ng://ngx-image-drawing/src/i18n.ts","ng://ngx-image-drawing/src/image-drawing.component.ts","ng://ngx-image-drawing/src/image-drawing.module.ts"],"names":["__decorate","decorators","target","key","desc","d","c","arguments","length","r","Object","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","__metadata","metadataKey","metadataValue","metadata","__read","o","n","m","Symbol","iterator","e","call","ar","next","done","push","value","error","I18nEn","saveBtn","cancelBtn","loadImage","loadImageUrl","loading","loadError","removeImage","sizes","small","medium","large","undo","redo","clear","colors","black","white","yellow","red","green","blue","purple","tools","brush","i18nLanguages","fr","en","ImageDrawingComponent","this","forceSizeCanvas","forceSizeExport","enableRemoveImage","enableLoadAnotherImage","enableTooltip","showCancelButton","locale","saveBtnText","cancelBtnText","loadingText","errorText","outputMimeType","outputQuality","borderCss","drawingSizes","save","EventEmitter","cancel","currentTool","currentSize","currentColor","i18n","canUndo","canRedo","isLoading","hasError","errorMessage","stack","colorsName","drawingSizesName","prototype","ngOnInit","_this","keys","canvas","fabric","Canvas","hoverCursor","isDrawingMode","backgroundColor","src","importPhotoFromSrc","width","height","Error","setWidth","setHeight","on","setUndoRedo","selectTool","selectColor","selectDrawingSize","toLowerCase","tool","size","freeDrawingBrush","color","lastId","getObjects","lastObj","remove","firstInStack","splice","insertAt","clearCanvas","_a","apply","concat","__spread","saveImage","canvasScaledElement","document","createElement","canvasScaled_1","Observable","observer","imageUsed","cloneAsImage","imageCloned","scaleToWidth","scaleToHeight","setBackgroundImage","img","complete","crossOrigin","originX","originY","pipe","switchMap","process","of","ratioX_1","getWidth","ratioY_1","getHeight","forEach","originalObject","observerObject","clone","clonedObject","set","left","top","renderAll","subscribe","getElement","toBlob","data","emit","cancelAction","getTextTranslated","name","strOk","split","reduce","i18nUser","str","console","getTooltipTranslated","importPhotoFromFile","event","files","file","type","match","importPhotoFromBlob","dispose","backgroundImage","isFirstTry","imgEl","Image","setAttribute","onerror","replace","onload","image","getScaledWidth","getScaledHeight","reader","FileReader","readAsDataURL","evtReader","readyState","DONE","result","importPhotoFromUrl","url","prompt","ngOnChanges","changes","firstChange","currentValue","Blob","tslib_1.__decorate","Input","TemplateRef","Output","Component","selector","template","ImageDrawingModule","NgModule","declarations","exports","imports","CommonModule"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export const I18nFr: I18nInterface = {\n    saveBtn: 'Enregistrer',\n    cancelBtn: 'Annuler',\n\n    loadImage: 'Charger une image depuis votre PC',\n    loadImageUrl: 'Charger une image depuis une URL',\n    loading: 'Chargement',\n    loadError: 'Erreur de chargement %@',\n    removeImage: 'Supprimer l\\'image',\n\n    sizes: {\n        small: 'Petit',\n        medium: 'Moyen',\n        large: 'Gros'\n    },\n\n    undo: 'Annuler',\n    redo: 'RÃ©pter',\n    clear: 'Effacer',\n\n    colors: {\n        black: 'Noir',\n        white: 'Blanc',\n        yellow: 'Jaune',\n        red: 'Rouge',\n        green: 'Vert',\n        blue: 'Blue',\n        purple: 'Violet'\n    },\n\n    tools: {\n        brush: 'Pinceau'\n    }\n};\n\nexport const I18nEn: I18nInterface = {\n    saveBtn: 'Save',\n    cancelBtn: 'Cancel',\n\n    loadImage: 'Load image',\n    loadImageUrl: 'Load image from URL',\n    loading: 'Loading',\n    loadError: 'Error loading %@',\n    removeImage: 'Remove image',\n\n    sizes: {\n        small: 'Small',\n        medium: 'Medium',\n        large: 'Large'\n    },\n\n    undo: 'Undo',\n    redo: 'Redo',\n    clear: 'Clear',\n\n    colors: {\n        black: 'Black',\n        white: 'White',\n        yellow: 'Yellow',\n        red: 'Red',\n        green: 'Green',\n        blue: 'Blue',\n        purple: 'Purple',\n    },\n\n    tools: {\n        brush: 'Brush'\n    }\n};\n\nexport const i18nLanguages: { [name: string]: I18nInterface } = {\n    fr: I18nFr,\n    en: I18nEn\n};\n\nexport interface I18nInterface {\n    saveBtn?: string;\n    cancelBtn?: string;\n\n    loadImage?: string;\n    loadImageUrl?: string;\n    loading?: string;\n    loadError?: string;\n    removeImage?: string;\n\n    sizes?: { [name: string]: string };\n\n    undo?: string;\n    redo?: string;\n    clear?: string;\n\n    colors?: { [name: string]: string };\n\n    tools?: { [name: string]: string };\n}\n","import { Component, EventEmitter, Input, OnChanges, OnInit, Output, SimpleChanges, TemplateRef } from '@angular/core';\nimport { fabric } from 'fabric';\nimport { I18nEn, I18nInterface, i18nLanguages } from './i18n';\nimport { Observable, of } from 'rxjs';\nimport { switchMap } from 'rxjs/operators';\n\n@Component({\n    selector: 'image-drawing',\n    styleUrls: ['./image-drawing.component.scss'],\n    templateUrl: './image-drawing.component.html'\n})\nexport class ImageDrawingComponent implements OnInit, OnChanges {\n\n    @Input() public src?: string;\n    @Input() public width?: number;\n    @Input() public height?: number;\n\n    @Input() public forceSizeCanvas = true;\n    @Input() public forceSizeExport = false;\n    @Input() public enableRemoveImage = false;\n    @Input() public enableLoadAnotherImage = false;\n    @Input() public enableTooltip = true;\n    @Input() public showCancelButton = true;\n\n    // @ts-ignore\n    @Input('i18n') public i18nUser: I18nInterface;\n    @Input() public locale: string = 'en';\n    /* @deprecated Use i18n.saveBtn */\n    @Input() public saveBtnText = 'Save';\n    /* @deprecated Use i18n.cancelBtn */\n    @Input() public cancelBtnText = 'Cancel';\n    /* @deprecated Use i18n.loading */\n    @Input() public loadingText = 'Loadingâ¦';\n    /* @deprecated Use i18n.loadError */\n    @Input() public errorText = 'Error loading %@';\n\n    @Input() public loadingTemplate?: TemplateRef<any>;\n    @Input() public errorTemplate?: TemplateRef<any>;\n\n    @Input() public outputMimeType = 'image/jpeg';\n    @Input() public outputQuality = 0.8;\n\n    @Input() public borderCss: string = 'none';\n\n    @Input() public drawingSizes: { [name: string]: number } = {\n        small: 5,\n        medium: 10,\n        large: 25,\n    };\n\n    @Input() public colors: { [name: string]: string } = {\n        black: '#000',\n        white: '#fff',\n        yellow: '#ffeb3b',\n        red: '#f44336',\n        blue: '#2196f3',\n        green: '#4caf50',\n        purple: '#7a08af',\n    };\n\n    @Output() public save: EventEmitter<Blob> = new EventEmitter<Blob>();\n    @Output() public cancel: EventEmitter<void> = new EventEmitter<void>();\n\n    public currentTool = 'brush';\n    public currentSize = 'medium';\n    public currentColor = 'black';\n    public i18n: I18nInterface = I18nEn;\n\n    public canUndo = false;\n    public canRedo = false;\n\n    public isLoading = false;\n    public hasError = false;\n    public errorMessage = '';\n\n    private canvas: fabric.Canvas;\n    private stack: fabric.Object[] = [];\n\n    public colorsName: string[] = [];\n    public drawingSizesName: string[] = [];\n\n    private imageUsed?: fabric.Image;\n\n    constructor() {\n    }\n\n    public ngOnInit(): void {\n        this.colorsName = Object.keys(this.colors);\n        this.drawingSizesName = Object.keys(this.drawingSizes);\n\n        this.canvas = new fabric.Canvas('canvas', {\n            hoverCursor: 'pointer',\n            isDrawingMode: true,\n        });\n        this.canvas.backgroundColor = 'white';\n\n        if (this.src) {\n            this.importPhotoFromSrc(this.src);\n        } else {\n            if (!this.width || !this.height) {\n                throw new Error('No width or hight given !');\n            }\n\n            this.canvas.setWidth(this.width);\n            this.canvas.setHeight(this.height);\n        }\n\n        this.canvas.on('path:created', () => {\n            this.stack = [];\n            this.setUndoRedo();\n        });\n\n        this.selectTool(this.currentTool);\n        this.selectColor(this.currentColor);\n        this.selectDrawingSize(this.currentSize);\n\n        if (this.locale && i18nLanguages[this.locale.toLowerCase()]) {\n            this.i18n = i18nLanguages[this.locale.toLowerCase()];\n        }\n\n        // FIXME remove after a while because properties are now deprecated\n        if (this.saveBtnText) {\n            this.i18n.saveBtn = this.saveBtnText;\n        }\n        if (this.cancelBtnText) {\n            this.i18n.cancelBtn = this.cancelBtnText;\n        }\n        if (this.loadingText) {\n            this.i18n.loading = this.loadingText;\n        }\n        if (this.errorText) {\n            this.i18n.loadError = this.errorText;\n        }\n    }\n\n    // Tools\n    public selectTool(tool: string) {\n        this.currentTool = tool;\n    }\n\n    public selectDrawingSize(size: string) {\n        this.currentSize = size;\n        if (this.canvas) {\n            this.canvas.freeDrawingBrush.width = this.drawingSizes[size];\n        }\n    }\n\n    public selectColor(color: string) {\n        this.currentColor = color;\n        if (this.canvas) {\n            this.canvas.freeDrawingBrush.color = this.colors[color];\n        }\n    }\n\n    // Actions\n\n    public undo() {\n        if (this.canUndo) {\n            const lastId = this.canvas.getObjects().length - 1;\n            const lastObj = this.canvas.getObjects()[lastId];\n            this.stack.push(lastObj);\n            this.canvas.remove(lastObj);\n            this.setUndoRedo();\n        }\n    }\n\n    public redo() {\n        if (this.canRedo) {\n            const firstInStack = this.stack.splice(-1, 1)[0];\n            if (firstInStack) {\n                this.canvas.insertAt(firstInStack, this.canvas.getObjects().length - 1, false);\n            }\n            this.setUndoRedo();\n        }\n    }\n\n    public clearCanvas() {\n        if (this.canvas) {\n            this.canvas.remove(...this.canvas.getObjects());\n            this.setUndoRedo();\n        }\n    }\n\n    public saveImage() {\n        if (!this.forceSizeExport || (this.forceSizeExport && this.width && this.height)) {\n            const canvasScaledElement: HTMLCanvasElement = document.createElement('canvas');\n            const canvasScaled = new fabric.Canvas(canvasScaledElement);\n            canvasScaled.backgroundColor = 'white';\n\n            new Observable<fabric.Canvas>(observer => {\n                if (this.imageUsed) {\n                    if (this.forceSizeExport) {\n                        canvasScaled.setWidth(this.width);\n                        canvasScaled.setHeight(this.height);\n\n                        this.imageUsed.cloneAsImage(imageCloned => {\n                            imageCloned.scaleToWidth(this.width, false);\n                            imageCloned.scaleToHeight(this.height, false);\n\n                            canvasScaled.setBackgroundImage(imageCloned, (img: HTMLImageElement) => {\n                                if (!img) {\n                                    observer.error(new Error('Impossible to draw the image on the temporary canvas'));\n                                }\n\n                                observer.next(canvasScaled);\n                                observer.complete();\n                            }, {\n                                crossOrigin: 'anonymous',\n                                originX: 'left',\n                                originY: 'top'\n                            });\n                        });\n                    } else {\n                        canvasScaled.setBackgroundImage(this.imageUsed, (img: HTMLImageElement) => {\n                            if (!img) {\n                                observer.error(new Error('Impossible to draw the image on the temporary canvas'));\n                            }\n\n                            canvasScaled.setWidth(img.width);\n                            canvasScaled.setHeight(img.height);\n\n                            observer.next(canvasScaled);\n                            observer.complete();\n                        }, {\n                            crossOrigin: 'anonymous',\n                            originX: 'left',\n                            originY: 'top'\n                        });\n                    }\n                } else {\n                    canvasScaled.setWidth(this.width);\n                    canvasScaled.setHeight(this.height);\n                }\n            }).pipe(\n                switchMap(() => {\n                    let process = of(canvasScaled);\n\n                    if (this.canvas.getObjects().length > 0) {\n                        const ratioX = canvasScaled.getWidth() / this.canvas.getWidth();\n                        const ratioY = canvasScaled.getHeight() / this.canvas.getHeight();\n\n                        this.canvas.getObjects().forEach((originalObject: fabric.Object, i: number) => {\n                            process = process.pipe(switchMap(() => {\n                                return new Observable<fabric.Canvas>(observerObject => {\n                                    originalObject.clone((clonedObject: fabric.Object) => {\n                                        clonedObject.set('left', originalObject.left * ratioX);\n                                        clonedObject.set('top', originalObject.top * ratioY);\n                                        clonedObject.scaleToWidth(originalObject.width * ratioX);\n                                        clonedObject.scaleToHeight(originalObject.height * ratioY);\n\n                                        canvasScaled.insertAt(clonedObject, i, false);\n                                        canvasScaled.renderAll();\n\n                                        observerObject.next(canvasScaled);\n                                        observerObject.complete();\n                                    });\n                                });\n                            }));\n                        });\n                    }\n                    return process;\n                }),\n            ).subscribe(() => {\n                canvasScaled.renderAll();\n                canvasScaled.getElement().toBlob(\n                    (data: Blob) => {\n                        this.save.emit(data);\n                    },\n                    this.outputMimeType,\n                    this.outputQuality\n                );\n            });\n        } else {\n            this.canvas.getElement().toBlob(\n                (data: Blob) => {\n                    this.save.emit(data);\n                },\n                this.outputMimeType,\n                this.outputQuality\n            );\n        }\n    }\n\n    public cancelAction() {\n        this.cancel.emit();\n    }\n\n    public getTextTranslated(name: string): string {\n        let strOk = name.split('.').reduce((o, i) => o[i], this.i18n as any);\n\n        if (this.i18nUser) {\n            try {\n                const str = name.split('.').reduce((o, i) => o[i], this.i18nUser as any);\n                if (str) {\n                    strOk = str;\n                }\n            } catch (e) {\n                // if we pass here, ignored\n            }\n        }\n\n        if (!strOk) {\n            console.error(name + ' translation not found !');\n        }\n\n        return strOk;\n    }\n\n    public getTooltipTranslated(name: string): string {\n        if (this.enableTooltip) {\n            return this.getTextTranslated(name)\n        } else {\n            return '';\n        }\n    }\n\n    private setUndoRedo() {\n        this.canUndo = this.canvas.getObjects().length > 0;\n        this.canRedo = this.stack.length > 0;\n        this.canvas.renderAll();\n    }\n\n    public importPhotoFromFile(event: Event | any) {\n        if (event.target.files && event.target.files.length > 0) {\n            const file = event.target.files[0];\n            if (file.type.match('image.*')) {\n                this.importPhotoFromBlob(file);\n            } else {\n                throw new Error('Not an image !');\n            }\n        }\n    }\n\n    public removeImage() {\n        if (this.imageUsed) {\n            this.imageUsed.dispose();\n            this.imageUsed = null;\n        }\n        this.canvas.backgroundImage = null;\n\n        if (this.width && this.height) {\n            this.canvas.setWidth(this.width);\n            this.canvas.setHeight(this.height);\n        }\n\n        this.canvas.renderAll();\n    }\n\n    public get hasImage(): boolean {\n        return !!this.canvas.backgroundImage;\n    }\n\n    private importPhotoFromSrc(src: string) {\n        this.isLoading = true;\n        let isFirstTry = true;\n        const imgEl = new Image();\n        imgEl.setAttribute('crossOrigin', 'anonymous');\n        imgEl.src = src;\n        imgEl.onerror = () => {\n            // Retry with cors proxy\n            if (isFirstTry) {\n                imgEl.src = 'https://cors-anywhere.herokuapp.com/' + this.src;\n                isFirstTry = false;\n            } else {\n                this.isLoading = false;\n                this.hasError = true;\n                this.errorMessage = this.getTextTranslated('loadError').replace('%@', this.src as string);\n            }\n        };\n        imgEl.onload = () => {\n            this.isLoading = false;\n            this.imageUsed = new fabric.Image(imgEl);\n\n            this.imageUsed.cloneAsImage(image => {\n                let width = imgEl.width;\n                let height = imgEl.height;\n\n                if (this.width) {\n                    width = this.width;\n                }\n                if (this.height) {\n                    height = this.height;\n                }\n\n                image.scaleToWidth(width, false);\n                image.scaleToHeight(height, false);\n\n                this.canvas.setBackgroundImage(image, ((img: HTMLImageElement) => {\n                    if (img) {\n                        if (this.forceSizeCanvas) {\n                            this.canvas.setWidth(width);\n                            this.canvas.setHeight(height);\n                        } else {\n                            this.canvas.setWidth(image.getScaledWidth());\n                            this.canvas.setHeight(image.getScaledHeight());\n                        }\n                    }\n                }), {\n                    crossOrigin: 'anonymous',\n                    originX: 'left',\n                    originY: 'top'\n                });\n            });\n        };\n    }\n\n    private importPhotoFromBlob(file: Blob | File) {\n        const reader = new FileReader();\n        reader.readAsDataURL(file);\n        reader.onload = (evtReader: any) => {\n            if (evtReader.target.readyState == FileReader.DONE) {\n                this.importPhotoFromSrc(evtReader.target.result);\n            }\n        };\n    }\n\n    public importPhotoFromUrl() {\n        const url = prompt(this.getTooltipTranslated('loadImageUrl'));\n        if (url) {\n            this.importPhotoFromSrc(url);\n        }\n    }\n\n    ngOnChanges(changes: SimpleChanges): void {\n        if (changes.src && !changes.src.firstChange && changes.src.currentValue) {\n            if (typeof changes.src.currentValue === 'string') {\n                this.importPhotoFromSrc(changes.src.currentValue);\n            } else if (changes.src.currentValue instanceof Blob) {\n                this.importPhotoFromBlob(changes.src.currentValue);\n            }\n        }\n    }\n}\n","import { CommonModule } from '@angular/common';\nimport { NgModule } from '@angular/core';\nimport { ImageDrawingComponent } from './image-drawing.component';\n\n@NgModule({\n    declarations: [\n        ImageDrawingComponent\n    ],\n    exports: [\n        ImageDrawingComponent,\n    ],\n    imports: [\n        CommonModule\n    ]\n})\nexport class ImageDrawingModule {}\n"]}